<!-- üåê BePeace Floating Language Selector (Final Version - Fully Working) -->
<style>
  /* üåê Floating Language Button */
  #lang-toggle {
    position: fixed;
    bottom: 80px;
    right: 25px;
    width: 52px;
    height: 52px;
    border-radius: 50%;
    background: linear-gradient(135deg, #ff91ae, #ffb6c1);
    color: #fff;
    border: none;
    font-size: 24px;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(0,0,0,0.25);
    z-index: 99999;
    transition: all 0.3s ease;
    animation: pulseGlow 3.5s infinite ease-in-out;
  }

  @keyframes pulseGlow {
    0% { box-shadow: 0 0 0 0 rgba(255,145,174,0.6); transform: scale(1); }
    50% { box-shadow: 0 0 20px 8px rgba(255,145,174,0.4); transform: scale(1.05); }
    100% { box-shadow: 0 0 0 0 rgba(255,145,174,0.6); transform: scale(1); }
  }

  #lang-toggle:hover {
    transform: scale(1.1);
    animation: none;
  }

  /* üåç Dropdown container */
  #google_translate_container {
    position: fixed;
    bottom: 140px;
    right: 25px;
    z-index: 99998;
    background: #fff;
    border: 1px solid #ffb6c1;
    border-radius: 12px;
    padding: 10px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.25);
    opacity: 0;
    visibility: hidden;
    transform: translateY(10px);
    transition: all 0.3s ease;
  }

  #google_translate_container.active {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }

  .goog-te-combo {
    border-radius: 8px;
    padding: 6px 10px;
    border: 1px solid #ff91ae;
    background-color: #fff0f6;
    color: #333;
    font-size: 13px;
  }

  .goog-te-banner-frame.skiptranslate { display: none !important; }
  body { top: 0px !important; }
</style>

<!-- üåê Floating Button -->
<button id="lang-toggle" title="Choose Language">üåê</button>

<!-- Hidden Dropdown Container -->
<div id="google_translate_container">
  <div id="google_translate_element"></div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const toggle = document.getElementById("lang-toggle");
  const container = document.getElementById("google_translate_container");

  // üåç Toggle dropdown open/close
  toggle.addEventListener("click", (e) => {
    e.stopPropagation();
    container.classList.toggle("active");
  });

  // Close dropdown if clicked outside
  document.addEventListener("click", (e) => {
    if (!container.contains(e.target) && !toggle.contains(e.target)) {
      container.classList.remove("active");
    }
  });

  // üåé Save language preference in cookie
  function setCookie(name, value, days) {
    const d = new Date();
    d.setTime(d.getTime() + (days * 24 * 60 * 60 * 1000));
    document.cookie = `${name}=${value};expires=${d.toUTCString()};path=/`;
  }

  function getCookie(name) {
    const v = document.cookie.match('(^|;) ?' + name + '=([^;]*)(;|$)');
    return v ? v[2] : null;
  }

  // üß† Watch for Translate Dropdown
  const observer = new MutationObserver(() => {
    const select = document.querySelector(".goog-te-combo");
    if (select) {
      const savedLang = getCookie("bepeace_lang");
      if (savedLang && savedLang !== "en") {
        select.value = savedLang;
        select.dispatchEvent(new Event("change"));
      }

      select.addEventListener("change", () => {
        const lang = select.value.split('-')[0];
        setCookie("bepeace_lang", lang, 30);
      });
    }
  });
  observer.observe(document.body, { childList: true, subtree: true });
});

// ‚úÖ Google Translate Init
function googleTranslateElementInit() {
  console.log("‚úÖ Google Translate Loaded");
  new google.translate.TranslateElement({
    pageLanguage: 'en',
    includedLanguages: 'af,sq,am,ar,hy,az,eu,be,bn,bg,ca,ceb,zh-CN,zh-TW,hr,cs,da,nl,en,et,fi,fr,de,el,gu,he,hi,hu,id,it,ja,kn,ko,ml,mr,my,ne,no,pa,pl,pt,ro,ru,si,sk,sl,so,es,sw,sv,ta,te,th,tr,uk,ur,vi,zh,zu',
    layout: google.translate.TranslateElement.InlineLayout.SIMPLE
  }, 'google_translate_element');
}

// üîÅ Auto-retry if Google is slow
let retryCount = 0;
function waitForGoogle() {
  if (window.google && google.translate && google.translate.TranslateElement) {
    googleTranslateElementInit();
  } else if (retryCount < 10) {
    retryCount++;
    setTimeout(waitForGoogle, 1000);
  } else {
    console.error("‚ùå Google Translate failed to load.");
  }
}
waitForGoogle();
</script>

<!-- ‚úÖ Always load Google script safely -->
<script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit" async defer></script>